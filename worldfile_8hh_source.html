<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html>
<!-- $Id: header.html,v 1.5 2008-02-24 23:24:40 rtv Exp $ -->

<HEAD>


<meta HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=utf-8">
<meta name="keywords" content="stage, robot, simulation, player, player/stage">
<link href="doxygen.css" rel="stylesheet" type="text/css">

<style type="text/css">

.floatright { float: right; margin: 0 0 1em 1em; }

body {
  font-family: sans-serif;
  #font-family: Geneva, Verdana, Helvetica, Arial, sans-serif;
  background-color: #FFF;
  color:#000;
}


a:link { 
	color: #A00;
}

a:visited { 
	color: #800;
}

a { text-decoration: none; }
a:hover { text-decoration: underline; }


.timestamp { text-align:right; background-color: #DDD; font-size:75%;}

h1 { 
  font-size:160%; 
}

h2 {
  font-size:110%;
  #color: #FFF;
  #background-color: #666;
  #padding:3px;
}

h3 { text-align:left; }

img {
  border: 0;
}

ul.menu { 
    position:relative;
    left:-2.5em;
    margin-bottom:0px;
    margin-top:0px;
}

ul.menu1 { 
    position:relative;
    left:-2.1em;
    margin-bottom:0px;
    margin-top:0px;
}

li.menu { 
    list-style-type: none;
    position:relative;
    #left:-0.5em;
}


#sidebar { position: absolute; left:0px; padding:2em; top:0em; width:11em;}

#content { position: absolute; left:12em; top:0em; padding-left:3em; padding-right:3em; padding-bottom:2em; margin-top:1em; margin-right:2em; }

div.box { background-color:#EEE; border: 1px solid #000; padding: 0.5ex 0.4em 0.5ex 0.6em; margin:1em;  }
div.box_light { background-color:#FFF; border: 1px solid #000; padding: 0.5ex 0.4em 0.5ex 0.6em; margin:1em;  }
div.title { font-weight:bold;  margin-bottom:2px;}

div.topbar { position: absolute; top:0px; left:9em; margin:1em; }

</style>

<TITLE>Stage Manual</TITLE>

</HEAD>

<body>

<div id="sidebar"> 

<h2 style="text-align:center;">
<a href="index.html"><img src="stage_button.png" alt="Stage logo image"></a>
</h2>

<div class="box">
<div class=title>Stage</div>

<ul class=menu>
<li class=menu><a href="index.html">Frontpage</a>
<li class=menu><a href="release.html">Release</a>
<li class=menu><a href="authors.html">Authors</a>
<li class=menu><a href="modules.html">Contents</a>
</div>


<div class="box">
<div class=title>User</div>
<ul class=menu>
<li class=menu><a href="install.html">Installation</a>
<li class=menu><a href="help.html">Help</a>
<hr>

<!-- the lists of plugins and models come next -->

<li class=menu><a href="group__world.html">World</a>
<li class=menu><a href="group__worldgui.html">WorldGUI</a>
<li class=menu><a href="group__model.html">Model</a>
<ul class=menu1>
<li class=menu><a href="group__model__actuator.html">actuator</a></li>
<li class=menu><a href="group__model__blobfinder.html">blobfinder</a></li>
<li class=menu><a href="group__model__camera.html">camera</a></li>
<li class=menu><a href="group__model__fiducial.html">fiducial</a></li>
<li class=menu><a href="group__model__gripper.html">gripper</a></li>
<li class=menu><a href="group__model__laser.html">laser</a></li>
<li class=menu><a href="group__model__position.html">position</a></li>
<li class=menu><a href="group__model__ranger.html">ranger</a></li>
<!--
TODO

<li class=menu><a href="group__model__bumper.html">bumper</a></li>
<li class=menu><a href="group__model__blinkenlight.html">blinkenlight</a></li>
-->
</ul>

</div>

<div class=box>
<div class="title">Player</div>
<li class=menu><a href="group__player.html">libstageplugin</a>
</div>


<div class=box>
<div class="title">Developer</div>
<a href="namespaces.html">libstage</a>
</div>

<div class=box_light>
<!-- <a href="http://sourceforge.net"><img border=0 src="http://sourceforge.net/sflogo.php?group_id=42445&type=1"></a> -->
<div class="title">Online</div>
<a href="http://playerstage.org">Homepage</a><br>
<a href="http://playerstage.sourceforge.net/wiki/Basic_FAQ">FAQ (Wiki)</a><br>
<a href="http://sourceforge.net/project/showfiles.php?group_id=42445">Download</a><br>
<a href="http://sourceforge.net/projects/playerstage">Project</a><br>
<a href="http://sourceforge.net/tracker/?group_id=42445">Bugs</a><br>
<a href="http://sourceforge.net/mail/?group_id=42445">Mailing Lists</a>
</div>


</div>

<div id="content" >
<!-- Generated by Doxygen 1.7.2 -->
  <div class="navpath">
    <ul>
      <li><a class="el" href="dir_b1518276d23a2e23b507fd99078f6343.html">libstage</a>      </li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>worldfile.hh</h1>  </div>
</div>
<div class="contents">
<a href="worldfile_8hh.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *  Stage : a multi-robot simulator.</span>
<a name="l00003"></a>00003 <span class="comment"> *  Copyright (C) 2001, 2002 Richard Vaughan, Andrew Howard and Brian Gerkey.</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  This program is free software; you can redistribute it and/or modify</span>
<a name="l00006"></a>00006 <span class="comment"> *  it under the terms of the GNU General Public License as published by</span>
<a name="l00007"></a>00007 <span class="comment"> *  the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00008"></a>00008 <span class="comment"> *  (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> *  This program is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00013"></a>00013 <span class="comment"> *  GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment"> *</span>
<a name="l00015"></a>00015 <span class="comment"> *  You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment"> *  along with this program; if not, write to the Free Software</span>
<a name="l00017"></a>00017 <span class="comment"> *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> */</span>
<a name="l00020"></a>00020 <span class="comment">/*</span>
<a name="l00021"></a>00021 <span class="comment"> * Desc: A class for reading in the world file.</span>
<a name="l00022"></a>00022 <span class="comment"> * Author: Andrew Howard, Richard Vaughan</span>
<a name="l00023"></a>00023 <span class="comment"> * Date: 15 Nov 2001</span>
<a name="l00024"></a>00024 <span class="comment"> * CVS info: $Id$</span>
<a name="l00025"></a>00025 <span class="comment"> */</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="preprocessor">#ifndef WORLDFILE_HH</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#define WORLDFILE_HH</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;stdint.h&gt;</span> <span class="comment">// for portable int types eg. uint32_t</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;stdio.h&gt;</span> <span class="comment">// for FILE ops</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">namespace </span>Stg {
<a name="l00035"></a>00035 
<a name="l00037"></a><a class="code" href="classStg_1_1CProperty.html">00037</a>   <span class="keyword">class </span><a class="code" href="classStg_1_1CProperty.html" title="Property class.">CProperty</a>
<a name="l00038"></a>00038   {
<a name="l00039"></a>00039   <span class="keyword">public</span>:
<a name="l00041"></a><a class="code" href="classStg_1_1CProperty.html#a4409013be121d32889b00862f0852bb9">00041</a>     <span class="keywordtype">int</span> <a class="code" href="classStg_1_1CProperty.html#a4409013be121d32889b00862f0852bb9" title="Index of entity this property belongs to.">entity</a>;
<a name="l00042"></a>00042 
<a name="l00044"></a><a class="code" href="classStg_1_1CProperty.html#a057ce9a0742c0b0e50da776bec65adda">00044</a>      std::string <a class="code" href="classStg_1_1CProperty.html#a057ce9a0742c0b0e50da776bec65adda" title="Name of property.">name</a>;
<a name="l00045"></a>00045     
<a name="l00047"></a><a class="code" href="classStg_1_1CProperty.html#ab10edbf9131799f620aaec7bb902ae7a">00047</a>      std::vector&lt;int&gt; <a class="code" href="classStg_1_1CProperty.html#ab10edbf9131799f620aaec7bb902ae7a" title="A list of token indexes.">values</a>;
<a name="l00048"></a>00048 
<a name="l00050"></a><a class="code" href="classStg_1_1CProperty.html#ad318ed64149e38d9ada73ec250d708bd">00050</a>     <span class="keywordtype">int</span> <a class="code" href="classStg_1_1CProperty.html#ad318ed64149e38d9ada73ec250d708bd" title="Line this property came from.">line</a>;
<a name="l00051"></a>00051 
<a name="l00053"></a><a class="code" href="classStg_1_1CProperty.html#aa30c89e502cea9eb578e3264a7e00026">00053</a>     <span class="keywordtype">bool</span> <a class="code" href="classStg_1_1CProperty.html#aa30c89e502cea9eb578e3264a7e00026" title="Flag set if property has been used.">used</a>;
<a name="l00054"></a>00054         
<a name="l00055"></a><a class="code" href="classStg_1_1CProperty.html#af0b08a13f661fdc8b1237e48aaa349d5">00055</a>      <a class="code" href="classStg_1_1CProperty.html#af0b08a13f661fdc8b1237e48aaa349d5">CProperty</a>( <span class="keywordtype">int</span> <a class="code" href="classStg_1_1CProperty.html#a4409013be121d32889b00862f0852bb9" title="Index of entity this property belongs to.">entity</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="classStg_1_1CProperty.html#a057ce9a0742c0b0e50da776bec65adda" title="Name of property.">name</a>, <span class="keywordtype">int</span> <a class="code" href="classStg_1_1CProperty.html#ad318ed64149e38d9ada73ec250d708bd" title="Line this property came from.">line</a> ) :
<a name="l00056"></a>00056         entity(entity), 
<a name="l00057"></a>00057         name(name),
<a name="l00058"></a>00058         <a class="code" href="classStg_1_1CProperty.html#ab10edbf9131799f620aaec7bb902ae7a" title="A list of token indexes.">values</a>(),
<a name="l00059"></a>00059         line(line),
<a name="l00060"></a>00060         <a class="code" href="classStg_1_1CProperty.html#aa30c89e502cea9eb578e3264a7e00026" title="Flag set if property has been used.">used</a>(false) {}
<a name="l00061"></a>00061   };
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 
<a name="l00064"></a>00064   <span class="comment">// Class for loading/saving world file.  This class hides the syntax</span>
<a name="l00065"></a>00065   <span class="comment">// of the world file and provides an &#39;entity.property = value&#39; style</span>
<a name="l00066"></a>00066   <span class="comment">// interface.  Global settings go in entity 0; every other entity</span>
<a name="l00067"></a>00067   <span class="comment">// refers to a specific entity.  Parent/child relationships are</span>
<a name="l00068"></a>00068   <span class="comment">// encoded in the form of entity/subentity relationships.</span>
<a name="l00069"></a><a class="code" href="classStg_1_1Worldfile.html">00069</a>   <span class="keyword">class </span><a class="code" href="classStg_1_1Worldfile.html">Worldfile</a>
<a name="l00070"></a>00070   {
<a name="l00071"></a>00071      <span class="comment">// Standard constructors/destructors</span>
<a name="l00072"></a>00072   <span class="keyword">public</span>: <a class="code" href="classStg_1_1Worldfile.html#a6b45bce3259b2cf422d3162cbec91b56">Worldfile</a>();
<a name="l00073"></a>00073   <span class="keyword">public</span>: <a class="code" href="classStg_1_1Worldfile.html#ab1781097758aefb91242521b8d80b8e5">~Worldfile</a>();
<a name="l00074"></a>00074 
<a name="l00075"></a>00075      <span class="comment">// replacement for fopen() that checks STAGEPATH dirs for the named file</span>
<a name="l00076"></a>00076      <span class="comment">// (thanks to  Douglas S. Blank &lt;dblank@brynmawr.edu&gt;)</span>
<a name="l00077"></a>00077   <span class="keyword">protected</span>: FILE* <a class="code" href="classStg_1_1Worldfile.html#ab998426f9a5056f81982b46182043c91">FileOpen</a>(<span class="keyword">const</span> std::string&amp; <a class="code" href="classStg_1_1Worldfile.html#a153fb729ac1999094a6598537464833d">filename</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* method);
<a name="l00078"></a>00078 
<a name="l00079"></a>00079      <span class="comment">// Load world from file</span>
<a name="l00080"></a>00080   <span class="keyword">public</span>: <span class="keywordtype">bool</span> <a class="code" href="classStg_1_1Worldfile.html#a4688b88880968a0cf70f44427c062c64">Load</a>(<span class="keyword">const</span> std::string&amp; filename );
<a name="l00081"></a>00081 
<a name="l00082"></a>00082      <span class="comment">// Save world back into file</span>
<a name="l00083"></a>00083      <span class="comment">// Set filename to NULL to save back into the original file</span>
<a name="l00084"></a>00084   <span class="keyword">public</span>: <span class="keywordtype">bool</span> <a class="code" href="classStg_1_1Worldfile.html#ac05188f3970c04369c0cd2e8aef156e9">Save</a>(<span class="keyword">const</span> std::string&amp; filename);
<a name="l00085"></a>00085 
<a name="l00086"></a>00086      <span class="comment">// Check for unused properties and print warnings</span>
<a name="l00087"></a>00087   <span class="keyword">public</span>: <span class="keywordtype">bool</span> <a class="code" href="classStg_1_1Worldfile.html#a2a3b6e50c5f67b7639e481a4d594e0c8">WarnUnused</a>();
<a name="l00088"></a>00088      
<a name="l00089"></a>00089      <span class="comment">// Read a string</span>
<a name="l00090"></a>00090   <span class="keyword">public</span>: <span class="keyword">const</span> std::string <a class="code" href="classStg_1_1Worldfile.html#a62a6c26f7b1b75a7aadf924b0adb4aed">ReadString</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span>* name, <span class="keyword">const</span> std::string&amp; value);
<a name="l00091"></a>00091 
<a name="l00092"></a>00092      <span class="comment">// Write a string</span>
<a name="l00093"></a>00093   <span class="keyword">public</span>: <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Worldfile.html#a5cd085f1a1f4532d839d51cf7de4d3c8">WriteString</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> std::string&amp; value );
<a name="l00094"></a>00094 
<a name="l00095"></a>00095      <span class="comment">// Read an integer </span>
<a name="l00096"></a>00096   <span class="keyword">public</span>: <span class="keywordtype">int</span> <a class="code" href="classStg_1_1Worldfile.html#a70afc43d48e74cb06034107eb7c5c299">ReadInt</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">int</span> value);
<a name="l00097"></a>00097 
<a name="l00098"></a>00098      <span class="comment">// Write an integer</span>
<a name="l00099"></a>00099   <span class="keyword">public</span>: <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Worldfile.html#a6708579b9f7d447511223d16c5887d51">WriteInt</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">int</span> value);
<a name="l00100"></a>00100 
<a name="l00101"></a>00101      <span class="comment">// Read a float </span>
<a name="l00102"></a>00102   <span class="keyword">public</span>: <span class="keywordtype">double</span> <a class="code" href="classStg_1_1Worldfile.html#ab4cbc024ef5553e21fd0bdeb6f04d8fb">ReadFloat</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> value);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104      <span class="comment">// Write a float</span>
<a name="l00105"></a>00105   <span class="keyword">public</span>: <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Worldfile.html#ac30e52d7877202eef70df654cc7df674">WriteFloat</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> value);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107      <span class="comment">// Read a length (includes unit conversion)</span>
<a name="l00108"></a>00108   <span class="keyword">public</span>: <span class="keywordtype">double</span> <a class="code" href="classStg_1_1Worldfile.html#ac859919dd2a0622d4d19a245e455c35c">ReadLength</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> value);
<a name="l00109"></a>00109 
<a name="l00110"></a>00110      <span class="comment">// Write a length (includes units conversion)</span>
<a name="l00111"></a>00111   <span class="keyword">public</span>: <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Worldfile.html#a0d6a38452caa5ed481508fba0befe5b2">WriteLength</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> value);
<a name="l00112"></a>00112   
<a name="l00113"></a>00113      <span class="comment">// Read an angle (includes unit conversion)</span>
<a name="l00114"></a>00114   <span class="keyword">public</span>: <span class="keywordtype">double</span> <a class="code" href="classStg_1_1Worldfile.html#a12146a5a689ac2ffea97407bc74589c4">ReadAngle</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">double</span> value);
<a name="l00115"></a>00115 
<a name="l00116"></a>00116      <span class="comment">// Read a boolean</span>
<a name="l00117"></a>00117      <span class="comment">// REMOVE? public: bool ReadBool(int entity, const char *name, bool value);</span>
<a name="l00118"></a>00118 
<a name="l00119"></a>00119      <span class="comment">// Read a color (includes text to RGB conversion)</span>
<a name="l00120"></a>00120   <span class="keyword">public</span>: uint32_t <a class="code" href="classStg_1_1Worldfile.html#aa6789d366d88bbadaea78b4d3edc9828">ReadColor</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, uint32_t value);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122      <span class="comment">// Read a file name.  Always returns an absolute path.  If the</span>
<a name="l00123"></a>00123      <span class="comment">// filename is entered as a relative path, we prepend the world</span>
<a name="l00124"></a>00124      <span class="comment">// files path to it.</span>
<a name="l00125"></a>00125   <span class="keyword">public</span>: <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classStg_1_1Worldfile.html#a8dbda5a3c51d502ccc28562f595bc299">ReadFilename</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">char</span> *value);
<a name="l00126"></a>00126   
<a name="l00127"></a>00127      <span class="comment">// Read a string from a tuple</span>
<a name="l00128"></a>00128   <span class="keyword">public</span>: <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classStg_1_1Worldfile.html#a0eb01bd9888e6bb519766495db71e602">ReadTupleString</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00129"></a>00129                                       <span class="keywordtype">int</span> index, <span class="keyword">const</span> <span class="keywordtype">char</span> *value);
<a name="l00130"></a>00130   
<a name="l00131"></a>00131      <span class="comment">// Write a string to a tuple</span>
<a name="l00132"></a>00132   <span class="keyword">public</span>: <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Worldfile.html#a28561b9a19a7fcd7a747fa1d0c9472cb">WriteTupleString</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00133"></a>00133                                 <span class="keywordtype">int</span> index, <span class="keyword">const</span> <span class="keywordtype">char</span> *value);
<a name="l00134"></a>00134   
<a name="l00135"></a>00135      <span class="comment">// Read a float from a tuple</span>
<a name="l00136"></a>00136   <span class="keyword">public</span>: <span class="keywordtype">double</span> <a class="code" href="classStg_1_1Worldfile.html#a1d251ef52445a19ccb216b2a124ff7ea">ReadTupleFloat</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00137"></a>00137                                 <span class="keywordtype">int</span> index, <span class="keywordtype">double</span> value);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139      <span class="comment">// Write a float to a tuple</span>
<a name="l00140"></a>00140   <span class="keyword">public</span>: <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Worldfile.html#ade931e73b7044a3c507499b1d8a193b8">WriteTupleFloat</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00141"></a>00141                                <span class="keywordtype">int</span> index, <span class="keywordtype">double</span> value);
<a name="l00142"></a>00142 
<a name="l00143"></a>00143      <span class="comment">// Read a length from a tuple (includes units conversion)</span>
<a name="l00144"></a>00144   <span class="keyword">public</span>: <span class="keywordtype">double</span> <a class="code" href="classStg_1_1Worldfile.html#ade1eb1b9f2e9825bdbe7942980f222c7">ReadTupleLength</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00145"></a>00145                                  <span class="keywordtype">int</span> index, <span class="keywordtype">double</span> value);
<a name="l00146"></a>00146 
<a name="l00147"></a>00147      <span class="comment">// Write a to a tuple length (includes units conversion)</span>
<a name="l00148"></a>00148   <span class="keyword">public</span>: <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Worldfile.html#a04e48c3542e225c44bb63fd026d3baab">WriteTupleLength</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00149"></a>00149                                 <span class="keywordtype">int</span> index, <span class="keywordtype">double</span> value);
<a name="l00150"></a>00150 
<a name="l00151"></a>00151      <span class="comment">// Read an angle form a tuple (includes units conversion)</span>
<a name="l00152"></a>00152   <span class="keyword">public</span>: <span class="keywordtype">double</span> <a class="code" href="classStg_1_1Worldfile.html#a37f24d5eed7ce075510426aea25c622d">ReadTupleAngle</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00153"></a>00153                                 <span class="keywordtype">int</span> index, <span class="keywordtype">double</span> value);
<a name="l00154"></a>00154 
<a name="l00155"></a>00155      <span class="comment">// Write an angle to a tuple (includes units conversion)</span>
<a name="l00156"></a>00156   <span class="keyword">public</span>: <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Worldfile.html#a4fb99a5f271c4266f59d01ecf47602b5">WriteTupleAngle</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00157"></a>00157                                <span class="keywordtype">int</span> index, <span class="keywordtype">double</span> value);
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 
<a name="l00161"></a>00161      <span class="comment">// Private methods used to load stuff from the world file</span>
<a name="l00162"></a>00162   
<a name="l00163"></a>00163      <span class="comment">// Load tokens from a file.</span>
<a name="l00164"></a>00164   <span class="keyword">private</span>: <span class="keywordtype">bool</span> LoadTokens(FILE *file, <span class="keywordtype">int</span> include);
<a name="l00165"></a>00165 
<a name="l00166"></a>00166      <span class="comment">// Read in a comment token</span>
<a name="l00167"></a>00167   <span class="keyword">private</span>: <span class="keywordtype">bool</span> LoadTokenComment(FILE *file, <span class="keywordtype">int</span> *line, <span class="keywordtype">int</span> include);
<a name="l00168"></a>00168 
<a name="l00169"></a>00169      <span class="comment">// Read in a word token</span>
<a name="l00170"></a>00170   <span class="keyword">private</span>: <span class="keywordtype">bool</span> LoadTokenWord(FILE *file, <span class="keywordtype">int</span> *line, <span class="keywordtype">int</span> include);
<a name="l00171"></a>00171 
<a name="l00172"></a>00172      <span class="comment">// Load an include token; this will load the include file.</span>
<a name="l00173"></a>00173   <span class="keyword">private</span>: <span class="keywordtype">bool</span> LoadTokenInclude(FILE *file, <span class="keywordtype">int</span> *line, <span class="keywordtype">int</span> include);
<a name="l00174"></a>00174 
<a name="l00175"></a>00175      <span class="comment">// Read in a number token</span>
<a name="l00176"></a>00176   <span class="keyword">private</span>: <span class="keywordtype">bool</span> LoadTokenNum(FILE *file, <span class="keywordtype">int</span> *line, <span class="keywordtype">int</span> include);
<a name="l00177"></a>00177 
<a name="l00178"></a>00178      <span class="comment">// Read in a string token</span>
<a name="l00179"></a>00179   <span class="keyword">private</span>: <span class="keywordtype">bool</span> LoadTokenString(FILE *file, <span class="keywordtype">int</span> *line, <span class="keywordtype">int</span> include);
<a name="l00180"></a>00180 
<a name="l00181"></a>00181      <span class="comment">// Read in a whitespace token</span>
<a name="l00182"></a>00182   <span class="keyword">private</span>: <span class="keywordtype">bool</span> LoadTokenSpace(FILE *file, <span class="keywordtype">int</span> *line, <span class="keywordtype">int</span> include);
<a name="l00183"></a>00183 
<a name="l00184"></a>00184      <span class="comment">// Save tokens to a file.</span>
<a name="l00185"></a>00185   <span class="keyword">private</span>: <span class="keywordtype">bool</span> SaveTokens(FILE *file);
<a name="l00186"></a>00186 
<a name="l00187"></a>00187      <span class="comment">// Clear the token list</span>
<a name="l00188"></a>00188   <span class="keyword">private</span>: <span class="keywordtype">void</span> ClearTokens();
<a name="l00189"></a>00189 
<a name="l00190"></a>00190      <span class="comment">// Add a token to the token list</span>
<a name="l00191"></a>00191   <span class="keyword">private</span>: <span class="keywordtype">bool</span> AddToken(<span class="keywordtype">int</span> type, <span class="keyword">const</span> <span class="keywordtype">char</span> *value, <span class="keywordtype">int</span> include);
<a name="l00192"></a>00192 
<a name="l00193"></a>00193      <span class="comment">// Set a token in the token list</span>
<a name="l00194"></a>00194   <span class="keyword">private</span>: <span class="keywordtype">bool</span> SetTokenValue(<span class="keywordtype">int</span> index, <span class="keyword">const</span> <span class="keywordtype">char</span> *value);
<a name="l00195"></a>00195 
<a name="l00196"></a>00196      <span class="comment">// Get the value of a token</span>
<a name="l00197"></a>00197   <span class="keyword">private</span>: <span class="keyword">const</span> <span class="keywordtype">char</span> *GetTokenValue(<span class="keywordtype">int</span> index);
<a name="l00198"></a>00198 
<a name="l00199"></a>00199      <span class="comment">// Dump the token list (for debugging).</span>
<a name="l00200"></a>00200   <span class="keyword">private</span>: <span class="keywordtype">void</span> DumpTokens();
<a name="l00201"></a>00201 
<a name="l00202"></a>00202      <span class="comment">// Parse a line</span>
<a name="l00203"></a>00203   <span class="keyword">private</span>: <span class="keywordtype">bool</span> ParseTokens();
<a name="l00204"></a>00204 
<a name="l00205"></a>00205      <span class="comment">// Parse an include statement</span>
<a name="l00206"></a>00206   <span class="keyword">private</span>: <span class="keywordtype">bool</span> ParseTokenInclude(<span class="keywordtype">int</span> *index, <span class="keywordtype">int</span> *line);
<a name="l00207"></a>00207 
<a name="l00208"></a>00208      <span class="comment">// Parse a macro definition</span>
<a name="l00209"></a>00209   <span class="keyword">private</span>: <span class="keywordtype">bool</span> ParseTokenDefine(<span class="keywordtype">int</span> *index, <span class="keywordtype">int</span> *line);
<a name="l00210"></a>00210 
<a name="l00211"></a>00211      <span class="comment">// Parse an word (could be a entity or an property) from the token list.</span>
<a name="l00212"></a>00212   <span class="keyword">private</span>: <span class="keywordtype">bool</span> ParseTokenWord(<span class="keywordtype">int</span> entity, <span class="keywordtype">int</span> *index, <span class="keywordtype">int</span> *line);
<a name="l00213"></a>00213 
<a name="l00214"></a>00214      <span class="comment">// Parse a entity from the token list.</span>
<a name="l00215"></a>00215   <span class="keyword">private</span>: <span class="keywordtype">bool</span> ParseTokenEntity(<span class="keywordtype">int</span> entity, <span class="keywordtype">int</span> *index, <span class="keywordtype">int</span> *line);
<a name="l00216"></a>00216 
<a name="l00217"></a>00217      <span class="comment">// Parse an property from the token list.</span>
<a name="l00218"></a>00218   <span class="keyword">private</span>: <span class="keywordtype">bool</span> ParseTokenProperty(<span class="keywordtype">int</span> entity, <span class="keywordtype">int</span> *index, <span class="keywordtype">int</span> *line);
<a name="l00219"></a>00219 
<a name="l00220"></a>00220      <span class="comment">// Parse a tuple.</span>
<a name="l00221"></a>00221   <span class="keyword">private</span>: <span class="keywordtype">bool</span> ParseTokenTuple( <a class="code" href="classStg_1_1CProperty.html" title="Property class.">CProperty</a>*  property, <span class="keywordtype">int</span> *index, <span class="keywordtype">int</span> *line);
<a name="l00222"></a>00222 
<a name="l00223"></a>00223      <span class="comment">// Clear the macro list</span>
<a name="l00224"></a>00224   <span class="keyword">private</span>: <span class="keywordtype">void</span> ClearMacros();
<a name="l00225"></a>00225 
<a name="l00226"></a>00226      <span class="comment">// Add a macro</span>
<a name="l00227"></a>00227   <span class="keyword">private</span>: <span class="keywordtype">void</span> AddMacro(<span class="keyword">const</span> <span class="keywordtype">char</span> *macroname, <span class="keyword">const</span> <span class="keywordtype">char</span> *entityname,
<a name="l00228"></a>00228                                  <span class="keywordtype">int</span> line, <span class="keywordtype">int</span> starttoken, <span class="keywordtype">int</span> endtoken);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230      <span class="comment">// Lookup a macro by name</span>
<a name="l00231"></a>00231 
<a name="l00232"></a>00232      <span class="comment">// Returns a pointer to a macro with this name, or NULL if there is none..</span>
<a name="l00233"></a>00233      <span class="keyword">class </span>CMacro;
<a name="l00234"></a>00234   <span class="keyword">private</span>: CMacro* LookupMacro(<span class="keyword">const</span> <span class="keywordtype">char</span> *macroname);
<a name="l00235"></a>00235 
<a name="l00236"></a>00236      <span class="comment">// Dump the macro list for debugging</span>
<a name="l00237"></a>00237   <span class="keyword">private</span>: <span class="keywordtype">void</span> DumpMacros();
<a name="l00238"></a>00238 
<a name="l00239"></a>00239      <span class="comment">// Clear the entity list</span>
<a name="l00240"></a>00240   <span class="keyword">private</span>: <span class="keywordtype">void</span> ClearEntities();
<a name="l00241"></a>00241 
<a name="l00242"></a>00242      <span class="comment">// Add a entity</span>
<a name="l00243"></a>00243   <span class="keyword">private</span>: <span class="keywordtype">int</span> AddEntity(<span class="keywordtype">int</span> parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *type);
<a name="l00244"></a>00244 
<a name="l00245"></a>00245     <span class="comment">// Get the number of entities.</span>
<a name="l00246"></a>00246   <span class="keyword">public</span>: <span class="keywordtype">int</span> <a class="code" href="classStg_1_1Worldfile.html#a1b31e5caffca6098ed49ab86a5d2578d">GetEntityCount</a>();
<a name="l00247"></a>00247 
<a name="l00248"></a>00248      <span class="comment">// Get a entity (returns the entity type value)</span>
<a name="l00249"></a>00249   <span class="keyword">public</span>: <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classStg_1_1Worldfile.html#a036d526b7153316810f278abb148a21d">GetEntityType</a>(<span class="keywordtype">int</span> entity);
<a name="l00250"></a>00250 
<a name="l00251"></a>00251      <span class="comment">// Lookup a entity number by type name</span>
<a name="l00252"></a>00252      <span class="comment">// Returns -1 if there is entity with this type</span>
<a name="l00253"></a>00253   <span class="keyword">public</span>: <span class="keywordtype">int</span> <a class="code" href="classStg_1_1Worldfile.html#a86b530f916fe2c9e2233d1b6aac38904">LookupEntity</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *type);
<a name="l00254"></a>00254   
<a name="l00255"></a>00255      <span class="comment">// Get a entity&#39;s parent entity.</span>
<a name="l00256"></a>00256      <span class="comment">// Returns -1 if there is no parent.</span>
<a name="l00257"></a>00257   <span class="keyword">public</span>: <span class="keywordtype">int</span> <a class="code" href="classStg_1_1Worldfile.html#a76a790b04ce4f1274e37058be7d146f5">GetEntityParent</a>(<span class="keywordtype">int</span> entity);
<a name="l00258"></a>00258 
<a name="l00259"></a>00259      <span class="comment">// Dump the entity list for debugging</span>
<a name="l00260"></a>00260   <span class="keyword">private</span>: <span class="keywordtype">void</span> DumpEntities();
<a name="l00261"></a>00261 
<a name="l00262"></a>00262      <span class="comment">// Clear the property list</span>
<a name="l00263"></a>00263   <span class="keyword">private</span>: <span class="keywordtype">void</span> ClearProperties();
<a name="l00264"></a>00264 
<a name="l00265"></a>00265      <span class="comment">// Add an property</span>
<a name="l00266"></a>00266   <span class="keyword">private</span>: <a class="code" href="classStg_1_1CProperty.html" title="Property class.">CProperty</a>* AddProperty(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">int</span> line);
<a name="l00267"></a>00267      <span class="comment">// Add an property value.</span>
<a name="l00268"></a>00268   <span class="keyword">private</span>: <span class="keywordtype">void</span> AddPropertyValue( <a class="code" href="classStg_1_1CProperty.html" title="Property class.">CProperty</a>* property, <span class="keywordtype">int</span> index, <span class="keywordtype">int</span> value_token);
<a name="l00269"></a>00269   
<a name="l00270"></a>00270      <span class="comment">// Get an property</span>
<a name="l00271"></a>00271   <span class="keyword">public</span>: <a class="code" href="classStg_1_1CProperty.html" title="Property class.">CProperty</a>* <a class="code" href="classStg_1_1Worldfile.html#a1a6d3702d1751b9bef3ecd5e46a043b2">GetProperty</a>(<span class="keywordtype">int</span> entity, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00272"></a>00272 
<a name="l00273"></a>00273      <span class="comment">// returns true iff the property exists in the file, so that you can</span>
<a name="l00274"></a>00274      <span class="comment">// be sure that GetProperty() will work</span>
<a name="l00275"></a>00275      <span class="keywordtype">bool</span> <a class="code" href="classStg_1_1Worldfile.html#abb1e46dc4740ef2f5151058484a8fc8b">PropertyExists</a>( <span class="keywordtype">int</span> section, <span class="keyword">const</span> <span class="keywordtype">char</span>* token );
<a name="l00276"></a>00276 
<a name="l00277"></a>00277      <span class="comment">// Set the value of an property.</span>
<a name="l00278"></a>00278   <span class="keyword">private</span>: <span class="keywordtype">void</span> SetPropertyValue( <a class="code" href="classStg_1_1CProperty.html" title="Property class.">CProperty</a>* property, <span class="keywordtype">int</span> index, <span class="keyword">const</span> <span class="keywordtype">char</span> *value);
<a name="l00279"></a>00279 
<a name="l00280"></a>00280      <span class="comment">// Get the value of an property.</span>
<a name="l00281"></a>00281   <span class="keyword">public</span>: <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="classStg_1_1Worldfile.html#a4822370b95b9498574bf674d12878236">GetPropertyValue</a>( <a class="code" href="classStg_1_1CProperty.html" title="Property class.">CProperty</a>* property, <span class="keywordtype">int</span> index);
<a name="l00282"></a>00282 
<a name="l00283"></a>00283      <span class="comment">// Dump the property list for debugging</span>
<a name="l00284"></a>00284   <span class="keyword">private</span>: <span class="keywordtype">void</span> DumpProperties();
<a name="l00285"></a>00285 
<a name="l00286"></a>00286      <span class="comment">// Token types.</span>
<a name="l00287"></a>00287   <span class="keyword">private</span>: <span class="keyword">enum</span>
<a name="l00288"></a>00288      {
<a name="l00289"></a>00289         TokenComment,
<a name="l00290"></a>00290         TokenWord, TokenNum, TokenString,
<a name="l00291"></a>00291         TokenOpenEntity, TokenCloseEntity,
<a name="l00292"></a>00292         TokenOpenTuple, TokenCloseTuple,
<a name="l00293"></a>00293         TokenSpace, TokenEOL
<a name="l00294"></a>00294      };
<a name="l00295"></a>00295     
<a name="l00296"></a>00296      <span class="comment">// Token structure.</span>
<a name="l00297"></a>00297   <span class="keyword">private</span>: 
<a name="l00298"></a>00298      <span class="keyword">class </span>CToken
<a name="l00299"></a>00299      {
<a name="l00300"></a>00300      <span class="keyword">public</span>:
<a name="l00301"></a>00301         <span class="comment">// Non-zero if token is from an include file.</span>
<a name="l00302"></a>00302         <span class="keywordtype">int</span> include;
<a name="l00303"></a>00303         
<a name="l00304"></a>00304         <span class="comment">// Token type (enumerated value).</span>
<a name="l00305"></a>00305         <span class="keywordtype">int</span> type;
<a name="l00306"></a>00306         
<a name="l00307"></a>00307         <span class="comment">// Token value</span>
<a name="l00308"></a>00308         std::string value;
<a name="l00309"></a>00309         
<a name="l00310"></a>00310         CToken( <span class="keywordtype">int</span> include, <span class="keywordtype">int</span> type, <span class="keyword">const</span> <span class="keywordtype">char</span>* value ) :
<a name="l00311"></a>00311           include(include), type(type), value(value) {}
<a name="l00312"></a>00312      };
<a name="l00313"></a>00313      
<a name="l00314"></a>00314      <span class="comment">// A list of tokens loaded from the file.</span>
<a name="l00315"></a>00315      <span class="comment">// Modified values are written back into the token list.</span>
<a name="l00316"></a>00316      <span class="comment">//private: int token_size, token_count;</span>
<a name="l00317"></a>00317   <span class="keyword">private</span>:  std::vector&lt;CToken&gt; tokens;
<a name="l00318"></a>00318 
<a name="l00319"></a>00319      <span class="comment">// Private macro class</span>
<a name="l00320"></a>00320   <span class="keyword">private</span>: 
<a name="l00321"></a>00321      <span class="keyword">class </span>CMacro
<a name="l00322"></a>00322      {
<a name="l00323"></a>00323      <span class="keyword">public</span>:
<a name="l00324"></a>00324         <span class="comment">// Name of macro</span>
<a name="l00325"></a>00325         std::string macroname;
<a name="l00326"></a>00326         
<a name="l00327"></a>00327         <span class="comment">// Name of entity</span>
<a name="l00328"></a>00328         std::string entityname;
<a name="l00329"></a>00329         
<a name="l00330"></a>00330         <span class="comment">// Line the macro definition starts on.</span>
<a name="l00331"></a>00331         <span class="keywordtype">int</span> line;
<a name="l00332"></a>00332         
<a name="l00333"></a>00333         <span class="comment">// Range of tokens in the body of the macro definition.</span>
<a name="l00334"></a>00334                  <span class="keywordtype">int</span> starttoken, endtoken;
<a name="l00335"></a>00335         
<a name="l00336"></a>00336         CMacro(<span class="keyword">const</span> <span class="keywordtype">char</span> *macroname, <span class="keyword">const</span> <span class="keywordtype">char</span> *entityname,
<a name="l00337"></a>00337                  <span class="keywordtype">int</span> line, <span class="keywordtype">int</span> starttoken, <span class="keywordtype">int</span> endtoken) :
<a name="l00338"></a>00338           macroname(macroname),
<a name="l00339"></a>00339           entityname(entityname),
<a name="l00340"></a>00340           line(line),
<a name="l00341"></a>00341           starttoken(starttoken),
<a name="l00342"></a>00342           endtoken(endtoken) {}
<a name="l00343"></a>00343      };
<a name="l00344"></a>00344      
<a name="l00345"></a>00345      <span class="comment">// Macro table</span>
<a name="l00346"></a>00346   <span class="keyword">private</span>: std::map&lt;std::string,CMacro&gt; macros;
<a name="l00347"></a>00347      
<a name="l00348"></a>00348      <span class="comment">// Private entity class</span>
<a name="l00349"></a>00349   <span class="keyword">private</span>: 
<a name="l00350"></a>00350      <span class="keyword">class </span>CEntity
<a name="l00351"></a>00351      {
<a name="l00352"></a>00352      <span class="keyword">public</span>:
<a name="l00353"></a>00353         <span class="comment">// Parent entity</span>
<a name="l00354"></a>00354         <span class="keywordtype">int</span> parent;
<a name="l00355"></a>00355         
<a name="l00356"></a>00356         <span class="comment">// Type of entity (i.e. position, laser, etc).</span>
<a name="l00357"></a>00357         std::string type;
<a name="l00358"></a>00358         
<a name="l00359"></a>00359         CEntity( <span class="keywordtype">int</span> parent, <span class="keyword">const</span> <span class="keywordtype">char</span>* type ) : parent(parent), type(type) {} 
<a name="l00360"></a>00360      };
<a name="l00361"></a>00361      
<a name="l00362"></a>00362      <span class="comment">// Entity list</span>
<a name="l00363"></a>00363   <span class="keyword">private</span>: std::vector&lt;CEntity&gt; entities;
<a name="l00364"></a>00364      
<a name="l00365"></a>00365      <span class="comment">// Property list</span>
<a name="l00366"></a>00366   <span class="keyword">private</span>: std::map&lt;std::string,CProperty*&gt; properties; 
<a name="l00367"></a>00367      
<a name="l00368"></a>00368      <span class="comment">// Name of the file we loaded</span>
<a name="l00369"></a><a class="code" href="classStg_1_1Worldfile.html#a153fb729ac1999094a6598537464833d">00369</a>   <span class="keyword">public</span>: std::string <a class="code" href="classStg_1_1Worldfile.html#a153fb729ac1999094a6598537464833d">filename</a>;
<a name="l00370"></a>00370      
<a name="l00371"></a>00371      <span class="comment">// Conversion units</span>
<a name="l00372"></a><a class="code" href="classStg_1_1Worldfile.html#a8e58a7776da5fed2fdf91ad633169631">00372</a>   <span class="keyword">public</span>: <span class="keywordtype">double</span> <a class="code" href="classStg_1_1Worldfile.html#a8e58a7776da5fed2fdf91ad633169631">unit_length</a>;
<a name="l00373"></a><a class="code" href="classStg_1_1Worldfile.html#a8eb7a372cd29148b189071ef99754741">00373</a>   <span class="keyword">public</span>: <span class="keywordtype">double</span> <a class="code" href="classStg_1_1Worldfile.html#a8eb7a372cd29148b189071ef99754741">unit_angle</a>;
<a name="l00374"></a>00374      
<a name="l00375"></a>00375   };
<a name="l00376"></a>00376     
<a name="l00377"></a>00377 };
<a name="l00378"></a>00378 
<a name="l00379"></a>00379 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Nov 26 2010 13:13:30 for Stage by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
