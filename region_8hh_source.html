<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html>
<!-- $Id: header.html,v 1.5 2008-02-24 23:24:40 rtv Exp $ -->

<HEAD>


<meta HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=utf-8">
<meta name="keywords" content="stage, robot, simulation, player, player/stage">
<link href="doxygen.css" rel="stylesheet" type="text/css">

<style type="text/css">

#.floatright { float: right; margin: 0 0 1em 1em; }

body {
  font-family: sans-serif;
  #font-family: Geneva, Verdana, Helvetica, Arial, sans-serif;
  background-color: #FFF;
  color:#000;
}


a:link { 
	color: #A00;
}

a:visited { 
	color: #800;
}

a { text-decoration: none; }
a:hover { text-decoration: underline; }


.timestamp { text-align:right; background-color: #DDD; font-size:75%;}

h1 { 
  font-size:160%; 
}

h2 {
  font-size:110%;
  #color: #FFF;
  #background-color: #666;
  #padding:3px;
}

h3 { text-align:left; }

img {
  border: 0;
}

ul.menu { 
    position:relative;
    left:-2.5em;
    margin-bottom:0px;
    margin-top:0px;
}

ul.menu1 { 
    position:relative;
    left:-2.1em;
    margin-bottom:0px;
    margin-top:0px;
}

li.menu { 
    list-style-type: none;
    position:relative;
    #left:-0.5em;
}


#sidebar { position: absolute; left:0px; padding:2em; top:0em; width:11em;}

#content { position: absolute; left:12em; top:0em; padding-left:3em; padding-right:3em; padding-bottom:2em; margin-top:1em; margin-right:2em; }

div.box { background-color:#EEE; border: 1px solid #000; padding: 0.5ex 0.4em 0.5ex 0.6em; margin:1em;  }
div.box_light { background-color:#FFF; border: 1px solid #000; padding: 0.5ex 0.4em 0.5ex 0.6em; margin:1em;  }
div.title { font-weight:bold;  margin-bottom:2px;}

div.topbar { position: absolute; top:0px; left:9em; margin:1em; }

</style>

<TITLE>Stage Manual</TITLE>

</HEAD>

<body>

<div id="sidebar"> 

<h2 style="text-align:center;">
<a href="index.html"><img src="stage_button.png" alt="Stage logo image"></a>
</h2>

<div class="box">
<div class=title>User</div>

<ul class=menu>
<li class=menu><a href="index.html">Frontpage</a>
<li class=menu><a href="release.html">Release</a>
<li class=menu><a href="authors.html">Authors</a>
<li class=menu><a href="install.html">Installation</a>

<hr>
<li class=menu><a href="modules.html">Contents</a>
</ul>

</div>

<div class=box>
<div class="title">Player</div>
<li class=menu><a href="group__player.html">libstageplugin</a>
</div>


<div class=box>
<div class="title">Developer</div>
<a href="namespaces.html">libstage</a>
</div>

<div class=box_light>
<!-- <a href="http://sourceforge.net"><img border=0 src="http://sourceforge.net/sflogo.php?group_id=42445&type=1"></a> -->
<div class="title">Online</div>


<a href="https://github.com/rtv/Stage">GitHub</a>
<a href="https://github.com/rtv/Stage/issues">Bugs/Issues</a>
<hr>
<a href="http://playerstage.org">Player Project</a><br>
<a href="http://sourceforge.net/mail/?group_id=42445">Mailing Lists</a>

</div>


</div>

<div id="content" >

<div>

<!-- Generated by Doxygen 1.7.5.1 -->
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_0c6038382477fcdf829efa1fe5d0e6c4.html">libstage</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">region.hh</div>  </div>
</div>
<div class="contents">
<a href="region_8hh.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#pragma once</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="comment">/*</span>
<a name="l00003"></a>00003 <span class="comment">  region.hh</span>
<a name="l00004"></a>00004 <span class="comment">  data structures supporting multi-resolution ray tracing in world class.</span>
<a name="l00005"></a>00005 <span class="comment">  Copyright Richard Vaughan 2008</span>
<a name="l00006"></a>00006 <span class="comment">*/</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;<a class="code" href="stage_8hh.html">stage.hh</a>&quot;</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="keyword">namespace </span>Stg 
<a name="l00011"></a>00011 {
<a name="l00012"></a>00012 
<a name="l00013"></a>00013   <span class="comment">// a bit of experimenting suggests that these values are fast. YMMV.</span>
<a name="l00014"></a>00014   <span class="keyword">const</span> int32_t <a class="code" href="namespaceStg.html#a332845aa7b999975409fdd41ab9b31b8">RBITS</a>( 5 ); <span class="comment">// regions contain (2^RBITS)^2 pixels</span>
<a name="l00015"></a>00015   <span class="keyword">const</span> int32_t <a class="code" href="namespaceStg.html#a38d5c7afbd593c9f7286374cfb9b7754">SBITS</a>( 5 );<span class="comment">// superregions contain (2^SBITS)^2 regions</span>
<a name="l00016"></a>00016   <span class="keyword">const</span> int32_t <a class="code" href="namespaceStg.html#ac1252e8add505351db22667f648ddcfb">SRBITS</a>( <a class="code" href="namespaceStg.html#a332845aa7b999975409fdd41ab9b31b8">RBITS</a>+<a class="code" href="namespaceStg.html#a38d5c7afbd593c9f7286374cfb9b7754">SBITS</a> );
<a name="l00017"></a>00017         
<a name="l00018"></a>00018   <span class="keyword">const</span> int32_t <a class="code" href="namespaceStg.html#a83b19ce4748047b1a09b6727aa6ec6b6">REGIONWIDTH</a>( 1&lt;&lt;<a class="code" href="namespaceStg.html#a332845aa7b999975409fdd41ab9b31b8">RBITS</a> );
<a name="l00019"></a>00019   <span class="keyword">const</span> int32_t <a class="code" href="namespaceStg.html#ad323d63cdbe752adfd811a4bea0393bc">REGIONSIZE</a>( <a class="code" href="namespaceStg.html#a83b19ce4748047b1a09b6727aa6ec6b6">REGIONWIDTH</a>*<a class="code" href="namespaceStg.html#a83b19ce4748047b1a09b6727aa6ec6b6">REGIONWIDTH</a> );
<a name="l00020"></a>00020 
<a name="l00021"></a>00021   <span class="keyword">const</span> int32_t <a class="code" href="namespaceStg.html#a3bee0193c7eb3b568c1bd1424812b087">SUPERREGIONWIDTH</a>( 1&lt;&lt;<a class="code" href="namespaceStg.html#a38d5c7afbd593c9f7286374cfb9b7754">SBITS</a> );
<a name="l00022"></a>00022   <span class="keyword">const</span> int32_t <a class="code" href="namespaceStg.html#adec4e23196a9a0e71ce9a3033b30bb30">SUPERREGIONSIZE</a>( <a class="code" href="namespaceStg.html#a3bee0193c7eb3b568c1bd1424812b087">SUPERREGIONWIDTH</a>*<a class="code" href="namespaceStg.html#a3bee0193c7eb3b568c1bd1424812b087">SUPERREGIONWIDTH</a> );
<a name="l00023"></a>00023         
<a name="l00024"></a>00024   <span class="keyword">const</span> int32_t <a class="code" href="namespaceStg.html#a92e4e7eb532cd76b7fb6cd08d6277cdc">CELLMASK</a>( ~((~0x00)&lt;&lt; <a class="code" href="namespaceStg.html#a332845aa7b999975409fdd41ab9b31b8">RBITS</a> ));
<a name="l00025"></a>00025   <span class="keyword">const</span> int32_t <a class="code" href="namespaceStg.html#ac2b58bd9a04b890649ea3cc1fa949578">REGIONMASK</a>( ~((~0x00)&lt;&lt; <a class="code" href="namespaceStg.html#ac1252e8add505351db22667f648ddcfb">SRBITS</a> ));
<a name="l00026"></a>00026         
<a name="l00027"></a><a class="code" href="namespaceStg.html#a5f7c3bca16962b4cf794b86e2f33de37">00027</a>   <span class="keyword">inline</span> int32_t <a class="code" href="namespaceStg.html#a5f7c3bca16962b4cf794b86e2f33de37">GETCELL</a>( <span class="keyword">const</span> int32_t x ) { <span class="keywordflow">return</span>( x &amp; <a class="code" href="namespaceStg.html#a92e4e7eb532cd76b7fb6cd08d6277cdc">CELLMASK</a>); }
<a name="l00028"></a><a class="code" href="namespaceStg.html#a81917e219f4a9c9ec08bcc53d2a2b92d">00028</a>   <span class="keyword">inline</span> int32_t <a class="code" href="namespaceStg.html#a81917e219f4a9c9ec08bcc53d2a2b92d">GETREG</a>(  <span class="keyword">const</span> int32_t x ) { <span class="keywordflow">return</span>( ( x &amp; <a class="code" href="namespaceStg.html#ac2b58bd9a04b890649ea3cc1fa949578">REGIONMASK</a> ) &gt;&gt; <a class="code" href="namespaceStg.html#a332845aa7b999975409fdd41ab9b31b8">RBITS</a>); }
<a name="l00029"></a><a class="code" href="namespaceStg.html#aa165e0f1b45cd28d2db4bd99853750a2">00029</a>   <span class="keyword">inline</span> int32_t <a class="code" href="namespaceStg.html#aa165e0f1b45cd28d2db4bd99853750a2">GETSREG</a>( <span class="keyword">const</span> int32_t x ) { <span class="keywordflow">return</span>( x &gt;&gt; <a class="code" href="namespaceStg.html#ac1252e8add505351db22667f648ddcfb">SRBITS</a>); }
<a name="l00030"></a>00030 
<a name="l00031"></a>00031   <span class="comment">// this is slightly faster than the inline method above, but not as safe</span>
<a name="l00032"></a>00032   <span class="comment">//#define GETREG(X) (( (static_cast&lt;int32_t&gt;(X)) &amp; REGIONMASK ) &gt;&gt; RBITS)</span>
<a name="l00033"></a>00033     
<a name="l00034"></a><a class="code" href="classStg_1_1Cell.html">00034</a>   <span class="keyword">class </span><a class="code" href="classStg_1_1Cell.html">Cell</a> 
<a name="l00035"></a>00035   {
<a name="l00036"></a><a class="code" href="classStg_1_1Cell.html#ac31376255d87f86be3c51faa360a285f">00036</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classStg_1_1SuperRegion.html">SuperRegion</a>;
<a name="l00037"></a><a class="code" href="classStg_1_1Cell.html#a7b4bcdf992c21ae83363f25df05b1d25">00037</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classStg_1_1World.html" title="World class">World</a>;
<a name="l00038"></a>00038      
<a name="l00039"></a>00039   <span class="keyword">private</span>:
<a name="l00040"></a>00040     std::vector&lt;Block*&gt; blocks[2];      
<a name="l00041"></a>00041      
<a name="l00042"></a>00042   <span class="keyword">public</span>:
<a name="l00043"></a><a class="code" href="classStg_1_1Cell.html#a7637d10597762b71be8fbcd87865af36">00043</a>     <a class="code" href="classStg_1_1Cell.html#a7637d10597762b71be8fbcd87865af36">Cell</a>() 
<a name="l00044"></a>00044       : blocks(), 
<a name="l00045"></a>00045     <a class="code" href="classStg_1_1Cell.html#a0e23e67c737d32e274f2daeda7e3dabe">region</a>(NULL)
<a name="l00046"></a>00046     { <span class="comment">/* nothing to do */</span> }                 
<a name="l00047"></a>00047      
<a name="l00048"></a>00048     <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Cell.html#a87c21f1ac2dc69345ef3642f3f0f0809">RemoveBlock</a>( <a class="code" href="classStg_1_1Block.html">Block</a>* b, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index );
<a name="l00049"></a>00049     <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Cell.html#a6367c861e798d19b302c84588798394b">AddBlock</a>( <a class="code" href="classStg_1_1Block.html">Block</a>* b, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index );
<a name="l00050"></a>00050     
<a name="l00051"></a><a class="code" href="classStg_1_1Cell.html#a8c5c20a6e80dbce06077b1d45f32bd7c">00051</a>     <span class="keyword">inline</span> <span class="keyword">const</span> std::vector&lt;Block*&gt;&amp; <a class="code" href="classStg_1_1Cell.html#a8c5c20a6e80dbce06077b1d45f32bd7c">GetBlocks</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index )
<a name="l00052"></a>00052     { <span class="keywordflow">return</span> blocks[index]; }
<a name="l00053"></a>00053      
<a name="l00054"></a><a class="code" href="classStg_1_1Cell.html#a0e23e67c737d32e274f2daeda7e3dabe">00054</a>     <a class="code" href="classStg_1_1Region.html">Region</a>* <a class="code" href="classStg_1_1Cell.html#a0e23e67c737d32e274f2daeda7e3dabe">region</a>;  
<a name="l00055"></a>00055   };  <span class="comment">// class Cell</span>
<a name="l00056"></a>00056   
<a name="l00057"></a><a class="code" href="classStg_1_1Region.html">00057</a>   <span class="keyword">class </span><a class="code" href="classStg_1_1Region.html">Region</a>
<a name="l00058"></a>00058   {
<a name="l00059"></a><a class="code" href="classStg_1_1Region.html#ac31376255d87f86be3c51faa360a285f">00059</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classStg_1_1SuperRegion.html">SuperRegion</a>;
<a name="l00060"></a><a class="code" href="classStg_1_1Region.html#a7b4bcdf992c21ae83363f25df05b1d25">00060</a>     <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classStg_1_1World.html" title="World class">World</a>; <span class="comment">// for raytracing</span>
<a name="l00061"></a>00061      
<a name="l00062"></a>00062   <span class="keyword">private</span>:
<a name="l00063"></a>00063     std::vector&lt;Cell&gt; cells;
<a name="l00064"></a>00064     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count; <span class="comment">// number of blocks rendered into this region</span>
<a name="l00065"></a>00065      
<a name="l00066"></a>00066   <span class="keyword">public</span>:
<a name="l00067"></a>00067     <a class="code" href="classStg_1_1Region.html#ac2c4033e7df0f8de6b560d37d464e6e0">Region</a>();
<a name="l00068"></a>00068     <a class="code" href="classStg_1_1Region.html#a01b0a8526e2ea7904cfe02482dbdaa47">~Region</a>();
<a name="l00069"></a>00069      
<a name="l00070"></a><a class="code" href="classStg_1_1Region.html#a6b681a58796018df40bfbc1cb7faa8e3">00070</a>     <span class="keyword">inline</span> <a class="code" href="classStg_1_1Cell.html">Cell</a>* <a class="code" href="classStg_1_1Region.html#a6b681a58796018df40bfbc1cb7faa8e3">GetCell</a>( int32_t x, int32_t y ) 
<a name="l00071"></a>00071     {   
<a name="l00072"></a>00072       <span class="keywordflow">if</span>( cells.size() == 0 )
<a name="l00073"></a>00073     {
<a name="l00074"></a>00074       assert(count == 0 );
<a name="l00075"></a>00075       
<a name="l00076"></a>00076       cells.resize( <a class="code" href="namespaceStg.html#ad323d63cdbe752adfd811a4bea0393bc">REGIONSIZE</a> );
<a name="l00077"></a>00077       
<a name="l00078"></a>00078       <span class="keywordflow">for</span>( int32_t c=0; c&lt;<a class="code" href="namespaceStg.html#ad323d63cdbe752adfd811a4bea0393bc">REGIONSIZE</a>;++c)
<a name="l00079"></a>00079         cells[c].region = <span class="keyword">this</span>;
<a name="l00080"></a>00080     } 
<a name="l00081"></a>00081       
<a name="l00082"></a>00082       <span class="keywordflow">return</span>( &amp;cells[ x + y * <a class="code" href="namespaceStg.html#a83b19ce4748047b1a09b6727aa6ec6b6">REGIONWIDTH</a> ] );
<a name="l00083"></a>00083     }
<a name="l00084"></a>00084          
<a name="l00085"></a>00085     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Region.html#a1654561d1a923214a2c28945d4f23ae4">AddBlock</a>();
<a name="l00086"></a>00086     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStg_1_1Region.html#a95f21d8430d5395e220a636fe7040074">RemoveBlock</a>(); 
<a name="l00087"></a>00087      
<a name="l00088"></a><a class="code" href="classStg_1_1Region.html#a6836844253880345e796f79a0653c022">00088</a>     <a class="code" href="classStg_1_1SuperRegion.html">SuperRegion</a>* <a class="code" href="classStg_1_1Region.html#a6836844253880345e796f79a0653c022">superregion</a>;   
<a name="l00089"></a>00089      
<a name="l00090"></a>00090   }; <span class="comment">// class Region</span>
<a name="l00091"></a>00091   
<a name="l00092"></a><a class="code" href="classStg_1_1SuperRegion.html">00092</a>   <span class="keyword">class </span><a class="code" href="classStg_1_1SuperRegion.html">SuperRegion</a>
<a name="l00093"></a>00093   {
<a name="l00094"></a>00094   <span class="keyword">private</span>:
<a name="l00095"></a>00095     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> count; <span class="comment">// number of blocks rendered into this superregion</span>
<a name="l00096"></a>00096     <a class="code" href="classStg_1_1point__int__t.html">point_int_t</a> origin;
<a name="l00097"></a>00097     <a class="code" href="classStg_1_1Region.html">Region</a> regions[<a class="code" href="namespaceStg.html#adec4e23196a9a0e71ce9a3033b30bb30">SUPERREGIONSIZE</a>];
<a name="l00098"></a>00098     <a class="code" href="classStg_1_1World.html" title="World class">World</a>* world;
<a name="l00099"></a>00099      
<a name="l00100"></a>00100   <span class="keyword">public</span>:    
<a name="l00101"></a>00101     <a class="code" href="classStg_1_1SuperRegion.html#a0ed193f9fcc89af0ad2c91d5bbe9182e">SuperRegion</a>( <a class="code" href="classStg_1_1World.html" title="World class">World</a>* world, <a class="code" href="classStg_1_1point__int__t.html">point_int_t</a> origin );
<a name="l00102"></a>00102     <a class="code" href="classStg_1_1SuperRegion.html#a3eefb7df0f63368f14b57e58055c9150">~SuperRegion</a>();
<a name="l00103"></a>00103      
<a name="l00104"></a><a class="code" href="classStg_1_1SuperRegion.html#ac72f66097e686282931e036e6601c4d3">00104</a>     <span class="keyword">inline</span> <a class="code" href="classStg_1_1Region.html">Region</a>* <a class="code" href="classStg_1_1SuperRegion.html#ac72f66097e686282931e036e6601c4d3">GetRegion</a>( int32_t x, int32_t y )
<a name="l00105"></a>00105     { 
<a name="l00106"></a>00106       <span class="keywordflow">return</span>( &amp;regions[ x + y * <a class="code" href="namespaceStg.html#a3bee0193c7eb3b568c1bd1424812b087">SUPERREGIONWIDTH</a> ]);
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108      
<a name="l00109"></a>00109     <span class="keywordtype">void</span> <a class="code" href="classStg_1_1SuperRegion.html#ab83a60a1f4c98b9df95cc0aca5b0a04e">DrawOccupancy</a>(<span class="keywordtype">void</span>) <span class="keyword">const</span>;
<a name="l00110"></a>00110     <span class="keywordtype">void</span> <a class="code" href="classStg_1_1SuperRegion.html#a89115afbc901c4cceb772744f52edd2e">DrawVoxels</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> layer) <span class="keyword">const</span>;
<a name="l00111"></a>00111          
<a name="l00112"></a>00112     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStg_1_1SuperRegion.html#acf1c6096196f47a2b95667bdbbd7dfd4">AddBlock</a>();
<a name="l00113"></a>00113     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classStg_1_1SuperRegion.html#a8e95fecb0bb87e3bbfdf31339e0b60cd">RemoveBlock</a>();      
<a name="l00114"></a>00114      
<a name="l00115"></a><a class="code" href="classStg_1_1SuperRegion.html#a380b6926179e4ab7ad444b5e581efc55">00115</a>     <span class="keyword">const</span> <a class="code" href="classStg_1_1point__int__t.html">point_int_t</a>&amp; <a class="code" href="classStg_1_1SuperRegion.html#a380b6926179e4ab7ad444b5e581efc55">GetOrigin</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> origin; }
<a name="l00116"></a>00116   }; <span class="comment">// class SuperRegion;</span>
<a name="l00117"></a>00117   
<a name="l00118"></a>00118         
<a name="l00119"></a>00119 }; <span class="comment">// namespace Stg</span>
</pre></div></div>
</div>


<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 29 2011 16:43:39 for Stage by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5.1
</small></address>

</body>
</html>
